{"version":3,"sources":["../src/Collapse1.js"],"names":[],"mappings":"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","file":"Collapse1.js","sourcesContent":["import React from 'react';\nimport {Motion, spring} from 'react-motion';\n\n\nconst PRECISION = 0.5;\nconst NO_ACTION = 'NO_ACTION';\nconst SHOULD_MEASURE = 'SHOULD_MEASURE';\nconst SHOULD_OPEN = 'SHOULD_OPEN';\nconst SHOULD_CLOSE = 'SHOULD_CLOSE';\n\n\nconst stringHeight = height => Math.max(0, parseFloat(height)).toFixed(1);\nconst noop = () => null;\n\n\nconst Height = React.createClass({\n  propTypes: {\n    shouldMeasure: React.PropTypes.bool,\n    onMeasure: React.PropTypes.func.isRequired,\n    children: React.PropTypes.node.isRequired\n  },\n\n\n  getDefaultProps() {\n    return {shouldMeasure: false};\n  },\n\n\n  componentDidMount() {\n    this.onMeasure();\n  },\n\n\n  shouldComponentUpdate(nextProps) {\n    return !this.props.shouldMeasure && nextProps.shouldMeasure;\n  },\n\n\n  componentDidUpdate() {\n    this.onMeasure();\n  },\n\n\n  onMeasure() {\n    if (this.props.shouldMeasure) {\n      this.props.onMeasure({\n        width: this.ref.clientWidth,\n        height: this.ref.clientHeight\n      });\n    }\n  },\n\n\n  setRef(ref) {\n    this.ref = ref;\n  },\n\n\n  render() {\n    const {\n      shouldMeasure: _shouldMeasure,\n      onMeasure: _onMeasure,\n      children,\n      ...props\n    } = this.props;\n\n\n    return <div ref={this.setRef} {...props}>{children}</div>;\n  }\n});\n\n\nexport default Height;\n\n\nexport const Collapse = React.createClass({\n  propTypes: {\n    isOpened: React.PropTypes.bool.isRequired,\n    keepCollapsedContent: React.PropTypes.bool,\n    springConfig: React.PropTypes.objectOf(React.PropTypes.number),\n\n    style: React.PropTypes.object,\n\n    onRest: React.PropTypes.func,\n    onHeightReady: React.PropTypes.func,\n\n    children: React.PropTypes.node.isRequired\n  },\n\n\n  getDefaultProps() {\n    return {\n      keepCollapsedContent: false,\n      style: {},\n      onRest: noop,\n      onHeightReady: noop\n    };\n  },\n\n\n  getInitialState() {\n    return {action: NO_ACTION};\n  },\n\n\n  componentWillMount() {\n    this.height = -1;\n  },\n\n\n  componentWillReceiveProps(nextProps) {\n    if (this.props.isOpened !== nextProps.isOpened) {\n      this.setState({action: SHOULD_MEASURE});\n      return;\n    }\n    if (!nextProps.isOpened) {\n      return;\n    }\n    if (\n      this.props.style !== nextProps.style ||\n      this.props.children !== nextProps.children\n    ) {\n      this.setState({action: SHOULD_MEASURE});\n    }\n  },\n\n\n  shouldComponentUpdate(nextProps, nextState) {\n    return this.state.action !== nextState.action ||\n      this.state.height !== nextState.height ||\n      this.props.children !== nextProps.children ||\n      this.props.style !== nextProps.style ||\n      this.props.springConfig !== nextProps.springConfig ||\n      this.props.keepCollapsedContent !== nextProps.keepCollapsedContent ||\n      this.props.onRest !== nextProps.onRest ||\n      this.props.onHeightReady !== nextProps.onHeightReady;\n  },\n\n\n  componentDidUpdate(_, prevState) {\n    if (prevState.action === SHOULD_MEASURE && this.state.action !== SHOULD_MEASURE) {\n      this.props.onHeightReady(this.height);\n    }\n  },\n\n\n  onMeasure({height}) {\n    console.log(`height`, height)\n    if (this.state.action !== SHOULD_MEASURE) {\n      return;\n    }\n    this.height = height;\n    this.setState({action: this.props.isOpened ? SHOULD_OPEN : SHOULD_CLOSE});\n  },\n\n\n//  getMotionHeight(height) {\n//    const {isOpened, springConfig} = this.props;\n//    const {isOpenedChanged} = this.state;\n//\n//    const newHeight = isOpenedChanged && !isOpened ? 0 : height;\n//    const newStringHeight = stringHeight(newHeight);\n//\n//    // No need to animate if content is closed and it was closed previously\n//    // Also no need to animate if height did not change\n//    const skipAnimation = !isOpenedChanged && !isOpened || this.height === newStringHeight;\n//\n//    return skipAnimation ? newHeight : spring(newHeight, {\n//      precision: PRECISION,\n//      ...springConfig\n//    });\n//  },\n\n\n  onRest() {\n    console.log(`rest!`);\n  },\n\n\n  render() {\n//    if (this.state.action === SHOULD_MEASURE) {\n//    }\n\n    console.log('action', this.state.action, 'height', this.height);\n\n    const content = (\n      <Height\n        shouldMeasure={this.state.action === SHOULD_MEASURE}\n        onMeasure={this.onMeasure}>\n        {this.props.children}\n      </Height>\n    );\n\n\n    const springConfig = {\n      precision: PRECISION,\n      ...this.props.springConfig\n    };\n\n\n    const motionStyle = {\n      [SHOULD_OPEN]: this.height < 0 ? {} : {height: spring(this.height, springConfig)},\n      [SHOULD_CLOSE]: this.height < 0 ? {} : {height: spring(this.height, springConfig)},\n      [SHOULD_MEASURE]: {},\n      [NO_ACTION]: {}\n    }[this.state.action];\n\n    const extraStyle = {\n      ...{\n        [SHOULD_OPEN]: {overflow: 'hidden'},\n        [SHOULD_CLOSE]: {overflow: 'hidden'},\n        [SHOULD_MEASURE]: {},\n        [NO_ACTION]: this.props.isOpened ? {height: 'auto'} : {overflow: 'hidden', height: 0}\n      }[this.state.action],\n      ...this.props.style\n    };\n\n    console.log(`motionStyle`, motionStyle)\n    return (\n      <Motion onRest={this.onRest} style={motionStyle}>\n        {st => <div style={{...extraStyle, ...st}}>{content}</div>}\n      </Motion>\n    );\n  }\n});\n"]}